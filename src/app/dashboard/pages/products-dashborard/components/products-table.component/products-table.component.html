<!-- src/app/features/products/components/products-table/products-table.component.html -->

<div class="products-table-container">
  <div class="table-header">
    <h3 class="table-title">قائمة المنتجات</h3>
    <div class="table-actions">
      <button class="btn btn-outline-primary" (click)="exportProducts()">
        <i class="bi bi-download me-2"></i>تصدير
      </button>
      <button class="btn btn-primary"><i class="bi bi-plus-circle me-2"></i>منتج جديد</button>
    </div>
  </div>

  <div class="table-scroll-wrapper">
    <div class="table-scroll-container">
      <table class="products-table">
        <thead>
          <tr>
            <th>#</th>
            <th>المنتج</th>
            <th>الفئة</th>
            <th>السعر</th>
            <th>المخزون</th>
            <th>الحالة</th>
            <th>الإجراءات</th>
          </tr>
        </thead>
        <tbody>
          @if (products().length === 0) {
            <tr>
              <td colspan="7" class="empty-state">
                <i class="bi bi-inbox"></i>
                <p>لا توجد منتجات</p>
              </td>
            </tr>
          } @else {
            @for (product of products(); track product.id; let i = $index) {
              <tr>
                <td>{{ i + 1 }}</td>
                <td>
                  <div class="product-info">
                    <div class="product-image-placeholder">
                      <i class="bi" [ngClass]="getCategoryConfig(product.category).icon"></i>
                    </div>
                    <div class="product-details">
                      <div class="product-name">{{ product.name }}</div>
                      <small class="product-code">رمز: {{ product.code }}</small>
                    </div>
                  </div>
                </td>
                <td>
                  <span
                    class="category-badge"
                    [ngClass]="getCategoryConfig(product.category).class"
                  >
                    {{ getCategoryConfig(product.category).label }}
                  </span>
                </td>
                <td>
                  <strong>{{ product.price | currency: 'USD' }}</strong>
                </td>
                <td>
                  <span class="stock-badge" [ngClass]="getStockLevel(product.stock)">
                    {{ getStockLabel(product.stock) }}
                  </span>
                </td>
                <td>
                  <span class="status-badge" [ngClass]="getStatusConfig(product.status).class">
                    {{ getStatusConfig(product.status).label }}
                  </span>
                </td>
                <td>
                  <div class="action-buttons">
                    <button class="action-btn preview" (click)="onView(product)">
                      <i class="bi bi-eye"></i>عرض
                    </button>
                    <button class="action-btn edit" (click)="onEdit(product)">
                      <i class="bi bi-pencil"></i>تعديل
                    </button>
                    @if (product.status !== 'inactive') {
                      <button class="action-btn inventory" (click)="onManageStock(product)">
                        <i class="bi bi-box-arrow-in-down"></i>مخزون
                      </button>
                    } @else {
                      <button class="action-btn delete" (click)="onDelete(product)">
                        <i class="bi bi-trash"></i>حذف
                      </button>
                    }
                  </div>
                </td>
              </tr>
            }
          }
        </tbody>
      </table>
    </div>
  </div>

  @if (totalPages() > 1) {
    <div class="pagination-container">
      <div class="pagination-info">{{ paginationInfo }}</div>
      <ul class="pagination">
        <li class="page-item">
          <button
            class="page-link"
            [disabled]="currentPage() === 1"
            (click)="goToPage(currentPage() - 1)"
          >
            <i class="bi bi-chevron-right"></i>
          </button>
        </li>
        @for (page of pageNumbers; track page) {
          <li class="page-item">
            <button
              class="page-link"
              [class.active]="page === currentPage()"
              (click)="goToPage(page)"
            >
              {{ page }}
            </button>
          </li>
        }
        <li class="page-item">
          <button
            class="page-link"
            [disabled]="currentPage() === totalPages()"
            (click)="goToPage(currentPage() + 1)"
          >
            <i class="bi bi-chevron-left"></i>
          </button>
        </li>
      </ul>
    </div>
  }
</div>
